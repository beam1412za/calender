<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏¥‡∏ß‡∏á‡∏≤‡∏ô | Nails Studio By C&N</title>
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css" rel="stylesheet" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;500&display=swap');
    body { margin: 0; font-family: 'Kanit', sans-serif; background: linear-gradient(to right, #ffd6ec, #fbe8ff); }
    header { background-color: #fff0f7; padding: 1rem 2rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1); text-align: center; }
    header h1 { margin: 0; color: #c2185b; font-weight: 500; }
    #calendar { max-width: 1000px; margin: 2rem auto; background: white; border-radius: 20px; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); padding: 20px; }
    .admin-controls { text-align: center; margin-bottom: 2rem; }
    .admin-controls button { margin: 0.3rem; }
    button.login-btn { background: linear-gradient(to right, #ec407a, #ab47bc); color: white; border: none; padding: 0.7em 1.5em; border-radius: 30px; font-size: 1rem; font-weight: bold; cursor: pointer; }
    button.login-btn:hover { background: linear-gradient(to right, #d81b60, #8e24aa); transform: translateY(-2px); }
    button#logoutBtn, button#clearBtn { background-color: #ba68c8; color: white; border: none; padding: 0.5em 1em; border-radius: 10px; cursor: pointer; }
    button#logoutBtn:hover, button#clearBtn:hover { background-color: #9c27b0; }
  </style>

  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyD0_uY8swDAzxjGxAD3jqehnQXtf3PNkj4",
      authDomain: "database-6bfe2.firebaseapp.com",
      databaseURL: "https://database-6bfe2-default-rtdb.firebaseio.com",
      projectId: "database-6bfe2",
      storageBucket: "database-6bfe2.appspot.com",
      messagingSenderId: "785373618624",
      appId: "1:785373618624:web:455ccad46c7558ab9fe825",
      measurementId: "G-2TTYFMNSWM"
    };
    firebase.initializeApp(firebaseConfig);
  </script>
</head>
<body>
  <header>
    <h1>üíÖ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏¥‡∏ß‡∏á‡∏≤‡∏ô Nails Studio By C&N</h1>
  </header>

  <div class="admin-controls">
    <button class="login-btn" onclick="login()">üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô</button>
    <button onclick="logout()" style="display: none;" id="logoutBtn">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
    <button onclick="clearEvents()" style="display: none;" id="clearBtn">üóë ‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏¥‡∏ß‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
  </div>

  <div id="calendar"></div>

  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>

  <script>
    let isAdmin = false;
    let calendar;

    document.addEventListener('DOMContentLoaded', function () {
      const calendarEl = document.getElementById('calendar');
      calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'timeGridWeek',
        locale: 'th',
        slotMinTime: '14:00:00',
        slotMaxTime: '23:00:00',
        hiddenDays: [2],
        headerToolbar: { left: 'prev,next today', center: 'title', right: 'timeGridWeek,dayGridMonth' },
        allDaySlot: false,
        editable: false,
        selectable: false,
        select: function(info) {
          if (!isAdmin) return;
          const title = prompt('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏á‡∏≤‡∏ô:');
          if (title) {
            const newEvent = { id: Date.now().toString(), title, start: info.startStr, end: info.endStr };
            firebase.database().ref("events/" + newEvent.id).set(newEvent);
          }
          calendar.unselect();
        },
        eventClick: function(info) {
          if (!isAdmin) return;
          if (confirm(`‡∏•‡∏ö‡∏á‡∏≤‡∏ô "${info.event.title}" ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) {
            firebase.database().ref("events/" + info.event.id).remove()
              .then(() => {
                info.event.remove();
              })
              .catch(err => {
                alert("‡∏•‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‚ùå " + err.message);
              });
          }
        }
      });

      function loadEvents() {
        firebase.database().ref("events").on("value", snapshot => {
          calendar.getEvents().forEach(e => e.remove());
          const data = snapshot.val();
          if (data) Object.values(data).forEach(event => calendar.addEvent(event));
        });
      }

      calendar.render();
      loadEvents();
    });

    function login() {
      const pass = prompt("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô:");
      if (pass === "1234") {
        isAdmin = true;
        alert("‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢ ‚úÖ");
        calendar.setOption('editable', true);
        calendar.setOption('selectable', true);
        document.getElementById('clearBtn').style.display = 'inline-block';
        document.getElementById('logoutBtn').style.display = 'inline-block';
      } else {
        alert("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‚ùå");
      }
    }

    function logout() {
      isAdmin = false;
      alert("‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
      calendar.setOption('editable', false);
      calendar.setOption('selectable', false);
      document.getElementById('clearBtn').style.display = 'none';
      document.getElementById('logoutBtn').style.display = 'none';
    }

    function clearEvents() {
      if (confirm("‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏¥‡∏ß‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?")) {
        firebase.database().ref("events").remove().then(() => {
          calendar.getEvents().forEach(e => e.remove());
        });
      }
    }
  </script>
</body>
</html>
